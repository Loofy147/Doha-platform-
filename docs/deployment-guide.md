# دليل نشر منصة لمسة ضحى

يهدف هذا الدليل إلى توضيح الخطوات والاعتبارات الأساسية لنشر منصة "لمسة ضحى" إلى بيئات مختلفة (تجريبية وإنتاجية). تعتمد المنصة بشكل أساسي على Next.js ويتم استضافتها حاليًا على Vercel.

## 1. المتطلبات الأساسية للنشر

قبل البدء في عملية النشر، تأكد من توفر ما يلي:

*   **حساب Vercel**: إذا كنت ستستخدم Vercel للنشر (وهو الخيار الموصى به لـ Next.js).
*   **مستودع Git**: يجب أن يكون كود المشروع مُدارًا باستخدام Git ومستضافًا على منصة مثل GitHub, GitLab, أو Bitbucket.
*   **إعداد متغيرات البيئة (Environment Variables)**:
    *   تأكد من أن جميع متغيرات البيئة المطلوبة (مثل `PEXELS_API_KEY`, `GOOGLE_API_KEY` لميزات Genkit) مُعرفة في إعدادات مشروع Vercel. لا تقم بتضمين هذه المفاتيح مباشرة في الكود أو في ملفات `.env.local` المرفوعة إلى المستودع.
    *   في Vercel، يمكنك إضافة متغيرات البيئة من خلال لوحة تحكم المشروع (Project Settings > Environment Variables).
*   **ملف `next.config.ts` (أو `next.config.js`)**: يجب أن يكون مهيأ بشكل صحيح.
*   **ملف `vercel.json`**: (اختياري في كثير من الحالات، ولكن يمكن استخدامه لتكوينات متقدمة). الملف الحالي في المشروع يوفر إعدادات أساسية.

## 2. عملية النشر باستخدام Vercel (موصى به)

تعتبر Vercel المنصة المثالية لنشر تطبيقات Next.js نظرًا للتكامل العميق بينهما.

### أ. ربط المشروع بـ Vercel:

1.  **إنشاء حساب/تسجيل الدخول**: إذا لم يكن لديك حساب على Vercel، قم بإنشاء واحد.
2.  **استيراد المشروع (Import Project)**:
    *   من لوحة تحكم Vercel، انقر على "Add New..." ثم "Project".
    *   اختر "Import Git Repository" وقم بربط حسابك على GitHub (أو المنصة التي تستخدمها).
    *   اختر المستودع الخاص بمنصة "لمسة ضحى".
3.  **تكوين المشروع**:
    *   سيقوم Vercel عادةً باكتشاف أن المشروع هو Next.js وتعيين إعدادات البناء والنشر المناسبة تلقائيًا.
    *   **Framework Preset**: يجب أن يكون "Next.js".
    *   **Build Command**: عادةً `next build` أو يمكنك تركه فارغًا ليستخدم Vercel الأمر الافتراضي.
    *   **Output Directory**: عادةً `.next`.
    *   **Install Command**: عادةً `npm install` أو `yarn install`.
    *   **Environment Variables**: قم بإضافة متغيرات البيئة المطلوبة هنا (مثل `PEXELS_API_KEY`, `GOOGLE_API_KEY`).

### ب. عملية النشر التلقائي:

*   **النشر من الفرع الرئيسي**: بمجرد ربط المشروع، سيقوم Vercel تلقائيًا بنشر أي تغييرات يتم دفعها (push) إلى الفرع الرئيسي (مثل `main` أو `master`).
*   **معاينات النشر (Preview Deployments)**: لكل طلب سحب (Pull Request) يتم فتحه ضد الفرع الرئيسي، سيقوم Vercel بإنشاء رابط معاينة (preview URL) تلقائي. هذا يسمح لك بمراجعة التغييرات واختبارها في بيئة شبيهة بالإنتاج قبل دمجها.
*   **التراجعات (Rollbacks)**: يوفر Vercel إمكانية التراجع بسهولة إلى أي نشر سابق إذا لزم الأمر.

### ج. النطاقات المخصصة (Custom Domains):

*   يمكنك بسهولة إضافة نطاق مخصص (مثل `www.lamsadoha.com`) إلى مشروعك على Vercel من خلال إعدادات النطاقات (Project Settings > Domains).
*   سيوفر Vercel الإرشادات اللازمة لتحديث سجلات DNS الخاصة بك.

## 3. البناء المحلي للإنتاج (Local Production Build)

إذا كنت ترغب في اختبار بناء الإنتاج محليًا قبل النشر (أو إذا كنت ستنشر يدويًا على خادم آخر)، يمكنك استخدام الأوامر التالية:

1.  **تثبيت الاعتماديات (إذا لم تكن مثبتة بالفعل)**:
    ```bash
    npm install 
    # أو
    yarn install
    ```
2.  **بناء التطبيق للإنتاج**:
    ```bash
    npm run build
    # أو
    yarn build
    ```
    سيقوم هذا الأمر بإنشاء مجلد `.next` يحتوي على النسخة المحسّنة من تطبيقك الجاهزة للإنتاج.

3.  **تشغيل خادم الإنتاج المحلي (اختياري للاختبار)**:
    ```bash
    npm run start
    # أو
    yarn start
    ```
    سيقوم هذا بتشغيل التطبيق باستخدام خادم Next.js المحسّن للإنتاج.

## 4. اعتبارات ما بعد النشر

*   **مراقبة الأداء (Performance Monitoring)**: استخدم أدوات مثل Vercel Analytics, Google Analytics, أو Sentry لمراقبة أداء التطبيق وتحديد أي مشكلات.
*   **مراقبة الأخطاء (Error Tracking)**: تكامل مع خدمة تتبع الأخطاء مثل Sentry لالتقاط الأخطاء التي تحدث في بيئة الإنتاج ومعالجتها.
*   **النسخ الاحتياطي (Backups)**: إذا كنت تستخدم قاعدة بيانات خارجية، تأكد من وجود استراتيجية نسخ احتياطي قوية.
*   **التحديثات الأمنية**: حافظ على تحديث تبعيات المشروع (dependencies) بانتظام لسد أي ثغرات أمنية مكتشفة.
*   **تحسين محركات البحث (SEO)**:
    *   تأكد من أن ملف `public/robots.txt` مهيأ بشكل صحيح للسماح لمحركات البحث بفهرسة الصفحات المهمة.
    *   قم بإنشاء وإرسال خريطة موقع (sitemap.xml) إلى Google Search Console و Bing Webmaster Tools. (يمكن استخدام حزم مثل `next-sitemap` لإنشاء خريطة الموقع تلقائيًا).
    *   استخدم أدوات تحليل SEO لمتابعة ترتيب ظهور موقعك وتحسينه.

## 5. ملفات مهمة لعملية النشر

*   **`package.json`**: يحدد الاعتماديات وسكريبتات البناء والتشغيل.
*   **`next.config.ts`**: يحتوي على تكوينات Next.js الخاصة بالمشروع (مثل إعدادات الصور، إعادة التوجيه، إلخ).
*   **`vercel.json`**: (اختياري لـ Vercel، لكن يمكن استخدامه لتكوينات متقدمة مثل إعادة التوجيه، الهيدرز، إلخ). الملف الحالي بالمشروع يحدد إصدار Node.js.
    ```json
    {
      "version": 2,
      "builds": [
        {
          "src": "next.config.ts", // أو package.json إذا كان هو نقطة الدخول الرئيسية
          "use": "@vercel/next"
        }
      ],
      "engines": {
        "node": "18.x" // تأكد من توافق هذا الإصدار مع متطلبات مشروعك
      }
    }
    ```
*   **`.env.local`**: (للتطوير المحلي فقط) لا يجب رفعه إلى المستودع. يجب تعيين متغيرات البيئة مباشرة في منصة الاستضافة.
*   **`.gitignore`**: تأكد من أنه يتضمن `node_modules`, `.next`, `.env.local` وملفات حساسة أخرى.

---
باتباع هذه الإرشادات، يمكنك نشر منصة "لمسة ضحى" بنجاح وضمان تشغيلها بكفاءة وأمان.
